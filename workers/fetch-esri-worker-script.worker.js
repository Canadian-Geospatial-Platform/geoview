/*! Package:fetch-esri-worker-script: 2.0.2 - "a331a5945a13ab17a82b43f298a7fb8a7771478d" - 2025-10-27T15:00:38.789Z */(()=>{var t={113:(t,e,r)=>{var n=r(852),o=r(857),i=r(389),a=r(207),u=r(879),c=r(509),s=r(835);function f(){"use strict";var e=o(),r=e.m(f),l=(Object.getPrototypeOf?Object.getPrototypeOf(r):r.__proto__).constructor;function p(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===l||"GeneratorFunction"===(e.displayName||e.name))}var h={throw:1,return:2,break:3,continue:3};function y(t){var e,r;return function(n){e||(e={stop:function(){return r(n.a,2)},catch:function(){return n.v},abrupt:function(t,e){return r(n.a,h[t],e)},delegateYield:function(t,o,i){return e.resultName=o,r(n.d,s(t),i)},finish:function(t){return r(n.f,t)}},r=function(t,r,o){n.p=e.prev,n.n=e.next;try{return t(r,o)}finally{e.next=n.n}}),e.resultName&&(e[e.resultName]=n.v,e.resultName=void 0),e.sent=n.v,e.next=n.n;try{return t.call(this,e)}finally{n.p=e.prev,n.n=e.next}}}return(t.exports=f=function(){return{wrap:function(t,r,n,o){return e.w(y(t),r,n,o&&o.reverse())},isGeneratorFunction:p,mark:e.m,awrap:function(t,e){return new n(t,e)},AsyncIterator:u,async:function(t,e,r,n,o){return(p(e)?a:i)(y(t),e,r,n,o)},keys:c,values:s}},t.exports.__esModule=!0,t.exports.default=t.exports)()}t.exports=f,t.exports.__esModule=!0,t.exports.default=t.exports},124:(t,e,r)=>{var n=r(113)();t.exports=n;try{regeneratorRuntime=n}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}},207:(t,e,r)=>{var n=r(857),o=r(879);t.exports=function(t,e,r,i,a){return new o(n().w(t,e,r,i),a||Promise)},t.exports.__esModule=!0,t.exports.default=t.exports},266:t=>{function e(r,n,o,i){var a=Object.defineProperty;try{a({},"",{})}catch(r){a=0}t.exports=e=function(t,r,n,o){function i(r,n){e(t,r,function(t){return this._invoke(r,n,t)})}r?a?a(t,r,{value:n,enumerable:!o,configurable:!o,writable:!o}):t[r]=n:(i("next",0),i("throw",1),i("return",2))},t.exports.__esModule=!0,t.exports.default=t.exports,e(r,n,o,i)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},389:(t,e,r)=>{var n=r(207);t.exports=function(t,e,r,o,i){var a=n(t,e,r,o,i);return a.next().then(function(t){return t.done?t.value:a.next()})},t.exports.__esModule=!0,t.exports.default=t.exports},509:t=>{t.exports=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},t.exports.__esModule=!0,t.exports.default=t.exports},778:t=>{function e(r){return t.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,e(r)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},835:(t,e,r)=>{var n=r(778).default;t.exports=function(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],r=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}}throw new TypeError(n(t)+" is not iterable")},t.exports.__esModule=!0,t.exports.default=t.exports},852:t=>{t.exports=function(t,e){this.v=t,this.k=e},t.exports.__esModule=!0,t.exports.default=t.exports},857:(t,e,r)=>{var n=r(266);function o(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */
var e,r,i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.toStringTag||"@@toStringTag";function c(t,o,i,a){var u=o&&o.prototype instanceof f?o:f,c=Object.create(u.prototype);return n(c,"_invoke",function(t,n,o){var i,a,u,c=0,f=o||[],l=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,r){return i=t,a=0,u=e,p.n=r,s}};function h(t,n){for(a=t,u=n,r=0;!l&&c&&!o&&r<f.length;r++){var o,i=f[r],h=p.p,y=i[2];t>3?(o=y===n)&&(u=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=t<2&&h<i[1])?(a=0,p.v=n,p.n=i[1]):h<y&&(o=t<3||i[0]>n||n>y)&&(i[4]=t,i[5]=n,p.n=y,a=0))}if(o||t>1)return s;throw l=!0,n}return function(o,f,y){if(c>1)throw TypeError("Generator is already running");for(l&&1===f&&h(f,y),a=f,u=y;(r=a<2?e:u)||!l;){i||(a?a<3?(a>1&&(p.n=-1),h(a,u)):p.n=u:p.v=u);try{if(c=2,i){if(a||(o="next"),r=i[o]){if(!(r=r.call(i,u)))throw TypeError("iterator result is not an object");if(!r.done)return r;u=r.value,a<2&&(a=0)}else 1===a&&(r=i.return)&&r.call(i),a<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=e}else if((r=(l=p.n<0)?u:t.call(n,p))!==s)break}catch(t){i=e,a=1,u=t}finally{c=1}}return{value:r,done:l}}}(t,i,a),!0),c}var s={};function f(){}function l(){}function p(){}r=Object.getPrototypeOf;var h=[][a]?r(r([][a]())):(n(r={},a,function(){return this}),r),y=p.prototype=f.prototype=Object.create(h);function v(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,n(t,u,"GeneratorFunction")),t.prototype=Object.create(y),t}return l.prototype=p,n(y,"constructor",p),n(p,"constructor",l),l.displayName="GeneratorFunction",n(p,u,"GeneratorFunction"),n(y),n(y,u,"Generator"),n(y,a,function(){return this}),n(y,"toString",function(){return"[object Generator]"}),(t.exports=o=function(){return{w:c,m:v}},t.exports.__esModule=!0,t.exports.default=t.exports)()}t.exports=o,t.exports.__esModule=!0,t.exports.default=t.exports},879:(t,e,r)=>{var n=r(852),o=r(266);t.exports=function t(e,r){function i(t,o,a,u){try{var c=e[t](o),s=c.value;return s instanceof n?r.resolve(s.v).then(function(t){i("next",t,a,u)},function(t){i("throw",t,a,u)}):r.resolve(s).then(function(t){c.value=t,a(c)},function(t){return i("throw",t,a,u)})}catch(t){u(t)}}var a;this.next||(o(t.prototype),o(t.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",function(){return this})),o(this,"_invoke",function(t,e,n){function o(){return new r(function(e,r){i(t,n,e,r)})}return a=a?a.then(o,o):o()},!0)},t.exports.__esModule=!0,t.exports.default=t.exports}},e={};function r(n){var o=e[n];if(void 0!==o)return o.exports;var i=e[n]={exports:{}};return t[n](i,i.exports,r),i.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";function t(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function e(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||function(e,r){if(e){if("string"==typeof e)return t(e,r);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?t(e,r):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function o(t){return function(){var e=this,r=arguments;return new Promise(function(o,i){var a=t.apply(e,r);function u(t){n(a,o,i,u,c,"next",t)}function c(t){n(a,o,i,u,c,"throw",t)}u(void 0)})}}var i=r(124),a=r.n(i);
/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
const u=Symbol("Comlink.proxy"),c=Symbol("Comlink.endpoint"),s=Symbol("Comlink.releaseProxy"),f=Symbol("Comlink.finalizer"),l=Symbol("Comlink.thrown"),p=t=>"object"==typeof t&&null!==t||"function"==typeof t,h={canHandle:t=>p(t)&&t[u],serialize(t){const{port1:e,port2:r}=new MessageChannel;return v(t,e),[r,[r]]},deserialize:t=>(t.start(),function(t,e){const r=new Map;return t.addEventListener("message",function(t){const{data:e}=t;if(!e||!e.id)return;const n=r.get(e.id);if(n)try{n(e)}finally{r.delete(e.id)}}),x(t,r,[],e)}(t))},y=new Map([["proxy",h],["throw",{canHandle:t=>p(t)&&l in t,serialize({value:t}){let e;return e=t instanceof Error?{isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:{isError:!1,value:t},[e,[]]},deserialize(t){if(t.isError)throw Object.assign(new Error(t.value.message),t.value);throw t.value}}]]);function v(t,e=globalThis,r=["*"]){e.addEventListener("message",function n(o){if(!o||!o.data)return;if(!function(t,e){for(const r of t){if(e===r||"*"===r)return!0;if(r instanceof RegExp&&r.test(e))return!0}return!1}(r,o.origin))return void console.warn(`Invalid origin '${o.origin}' for comlink proxy`);const{id:i,type:a,path:c}=Object.assign({path:[]},o.data),s=(o.data.argumentList||[]).map(E);let p;try{const e=c.slice(0,-1).reduce((t,e)=>t[e],t),r=c.reduce((t,e)=>t[e],t);switch(a){case"GET":p=r;break;case"SET":e[c.slice(-1)[0]]=E(o.data.value),p=!0;break;case"APPLY":p=r.apply(e,s);break;case"CONSTRUCT":p=function(t){return Object.assign(t,{[u]:!0})}(new r(...s));break;case"ENDPOINT":{const{port1:e,port2:r}=new MessageChannel;v(t,r),p=function(t,e){return k.set(t,e),t}(e,[e])}break;case"RELEASE":p=void 0;break;default:return}}catch(t){p={value:t,[l]:0}}Promise.resolve(p).catch(t=>({value:t,[l]:0})).then(r=>{const[o,u]=j(r);e.postMessage(Object.assign(Object.assign({},o),{id:i}),u),"RELEASE"===a&&(e.removeEventListener("message",n),d(e),f in t&&"function"==typeof t[f]&&t[f]())}).catch(t=>{const[r,n]=j({value:new TypeError("Unserializable return value"),[l]:0});e.postMessage(Object.assign(Object.assign({},r),{id:i}),n)})}),e.start&&e.start()}function d(t){(function(t){return"MessagePort"===t.constructor.name})(t)&&t.close()}function b(t){if(t)throw new Error("Proxy has been released and is not useable")}function m(t){return S(t,new Map,{type:"RELEASE"}).then(()=>{d(t)})}const g=new WeakMap,w="FinalizationRegistry"in globalThis&&new FinalizationRegistry(t=>{const e=(g.get(t)||0)-1;g.set(t,e),0===e&&m(t)});function x(t,e,r=[],n=function(){}){let o=!1;const i=new Proxy(n,{get(n,a){if(b(o),a===s)return()=>{!function(t){w&&w.unregister(t)}(i),m(t),e.clear(),o=!0};if("then"===a){if(0===r.length)return{then:()=>i};const n=S(t,e,{type:"GET",path:r.map(t=>t.toString())}).then(E);return n.then.bind(n)}return x(t,e,[...r,a])},set(n,i,a){b(o);const[u,c]=j(a);return S(t,e,{type:"SET",path:[...r,i].map(t=>t.toString()),value:u},c).then(E)},apply(n,i,a){b(o);const u=r[r.length-1];if(u===c)return S(t,e,{type:"ENDPOINT"}).then(E);if("bind"===u)return x(t,e,r.slice(0,-1));const[s,f]=O(a);return S(t,e,{type:"APPLY",path:r.map(t=>t.toString()),argumentList:s},f).then(E)},construct(n,i){b(o);const[a,u]=O(i);return S(t,e,{type:"CONSTRUCT",path:r.map(t=>t.toString()),argumentList:a},u).then(E)}});return function(t,e){const r=(g.get(e)||0)+1;g.set(e,r),w&&w.register(t,e,t)}(i,t),i}function O(t){const e=t.map(j);return[e.map(t=>t[0]),(r=e.map(t=>t[1]),Array.prototype.concat.apply([],r))];var r}const k=new WeakMap;function j(t){for(const[e,r]of y)if(r.canHandle(t)){const[n,o]=r.serialize(t);return[{type:"HANDLER",name:e,value:n},o]}return[{type:"RAW",value:t},k.get(t)||[]]}function E(t){switch(t.type){case"HANDLER":return y.get(t.name).deserialize(t.value);case"RAW":return t.value}}function S(t,e,r,n){return new Promise(o=>{const i=new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-");e.set(i,o),t.start&&t.start(),t.postMessage(Object.assign({id:i},r),n)})}function P(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _(t){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_(t)}function M(t){var e=function(t,e){if("object"!=_(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==_(e)?e:e+""}function T(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,M(n.key),n)}}function A(t,e,r){return e&&T(t.prototype,e),r&&T(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function R(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function C(t,e){return t.get(N(t,e))}function N(t,e,r){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var F=new WeakMap,W=new WeakSet,L=function(){return A(function t(){var e,r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";P(this,t),R(e=this,r=W),r.add(e),function(t,e,r){R(t,e),e.set(t,r)}(this,F,void 0),function(t,e,r){t.set(N(t,e),r)}(F,this,n)},[{key:"logInfo",value:function(){for(var t,e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];(t=N(W,this,G)).call.apply(t,[this,"log","info"].concat(r))}},{key:"logWarning",value:function(){for(var t,e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];(t=N(W,this,G)).call.apply(t,[this,"log","warning"].concat(r))}},{key:"logError",value:function(){for(var t,e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];(t=N(W,this,G)).call.apply(t,[this,"log","error"].concat(r))}},{key:"logDebug",value:function(){for(var t,e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];(t=N(W,this,G)).call.apply(t,[this,"log","debug"].concat(r))}},{key:"logTrace",value:function(){for(var t,e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];(t=N(W,this,G)).call.apply(t,[this,"log","trace"].concat(r))}},{key:"sendMessage",value:function(t){for(var e,r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];(e=N(W,this,G)).call.apply(e,[this,"message",t].concat(n))}}])}();function G(t,e){for(var r=arguments.length,n=new Array(r>2?r-2:0),o=2;o<r;o++)n[o-2]=arguments[o];var i=C(F,this)?[C(F,this)].concat(n):n;self.postMessage({type:t,level:e,message:i})}function z(t,e,r){return(e=M(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function I(t,e){if(e&&("object"==_(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function D(t){return D=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},D(t)}function q(t,e){return q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},q(t,e)}function H(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(H=function(){return!!t})()}function B(t){var e="function"==typeof Map?new Map:void 0;return B=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return function(t,e,r){if(H())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,e);var o=new(t.bind.apply(t,n));return r&&q(o,r.prototype),o}(t,arguments,D(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),q(r,t)},B(t)}function U(t,e,r){return e=D(e),I(t,Y()?Reflect.construct(e,r||[],D(t).constructor):e.apply(t,r))}function Y(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Y=function(){return!!t})()}var $=function(t){function e(t){var r;return P(this,e),(r=U(this,e,["Request timed out after ".concat(t,"ms")])).name="RequestTimeoutError",Error.captureStackTrace&&Error.captureStackTrace(r,e),Object.setPrototypeOf(r,e.prototype),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&q(t,e)}(e,t),A(e)}(B(Error));function J(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function Q(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?J(Object(r),!0).forEach(function(e){z(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):J(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}var X=function(){var t=o(a().mark(function t(e){var r,n,o,i,u,c,s,f=arguments;return a().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=f.length>1&&void 0!==f[1]?f[1]:{},n=f.length>2&&void 0!==f[2]?f[2]:7e3,o=new AbortController,i=setTimeout(function(){return o.abort()},n),t.prev=1,t.next=2,fetch(e,Q(Q({},r),{},{signal:o.signal}));case 2:if((u=t.sent).ok){t.next=3;break}throw new Error("HTTP error! status: ".concat(u.status));case 3:return t.next=4,u.json();case 4:return c=t.sent,t.abrupt("return",c);case 5:if(t.prev=5,!((s=t.catch(1))instanceof DOMException&&"AbortError"===s.name)){t.next=6;break}throw new $(n);case 6:throw s;case 7:return t.prev=7,clearTimeout(i),t.finish(7);case 8:case"end":return t.stop()}},t,null,[[1,5,7,8]])}));return function(e){return t.apply(this,arguments)}}();function K(t,e,r){V(t,e),e.set(t,r)}function V(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Z(t,e){return t.get(et(t,e))}function tt(t,e,r){return t.set(et(t,e),r),r}function et(t,e,r){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var rt=new WeakMap,nt=new WeakMap,ot=new WeakMap,it=new WeakMap,at=new WeakMap,ut=new WeakMap,ct=new WeakSet,st=function(){return A(function t(e){var r,n;if(P(this,t),V(r=this,n=ct),n.add(r),K(this,rt,void 0),K(this,nt,void 0),K(this,ot,void 0),K(this,it,void 0),K(this,at,void 0),K(this,ut,void 0),e<=0)throw new Error("workersCount must be positive");tt(nt,this,e),tt(rt,this,e),tt(ot,this,[]),tt(it,this,[]),et(ct,this,vt).call(this)},[{key:"withLock",value:(e=o(a().mark(function t(e){return a().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=1,et(ct,this,ht).call(this);case 1:return t.abrupt("return",et(ct,this,ft).call(this,e));case 2:case"end":return t.stop()}},t,this)})),function(t){return e.apply(this,arguments)})},{key:"withLockRunAndForget",value:(t=o(a().mark(function t(e){return a().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=1,et(ct,this,ht).call(this);case 1:et(ct,this,ft).call(this,e);case 2:case"end":return t.stop()}},t,this)})),function(e){return t.apply(this,arguments)})},{key:"awaitTerminate",value:function(){return Z(rt,this)<Z(nt,this)?Z(ut,this):Promise.resolve()}}]);var t,e}();function ft(t){return lt.apply(this,arguments)}function lt(){return(lt=o(a().mark(function t(e){return a().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=1,e();case 1:return t.abrupt("return",t.sent);case 2:return t.prev=2,et(ct,this,yt).call(this),t.finish(2);case 3:case"end":return t.stop()}},t,this,[[0,,2,3]])}))).apply(this,arguments)}function pt(){return Z(it,this).length||(tt(it,this,Z(ot,this).reverse()),tt(ot,this,[])),Z(it,this)}function ht(){if(!(Z(rt,this)>0)){var t=function(){},e=new Promise(function(e){t=e});return Z(ot,this).push(t),e}tt(rt,this,Z(rt,this)-1)}function yt(){var t=et(ct,this,pt).call(this);if(t.length){var e=t.pop();e&&e()}else if(tt(rt,this,Z(rt,this)+1),Z(rt,this)>=Z(nt,this)){var r=Z(at,this);et(ct,this,vt).call(this),r()}}function vt(){var t=function(){};tt(ut,this,new Promise(function(e){t=e})),tt(at,this,t)}var dt=new L("FetchEsriWorker");function bt(){return(bt=o(a().mark(function t(e){var r,n;return a().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r="?objectIds=".concat(e.objectIds,"&outFields=*&returnGeometry=").concat(e.queryGeometry,"&outSR=").concat(e.projection,"&geometryPrecision=1&maxAllowableOffset=").concat(e.maxAllowableOffset,"&f=json"),t.next=1,fetch("".concat(e.url,"/query").concat(r));case 1:return n=t.sent,t.abrupt("return",n.json());case 2:case"end":return t.stop()}},t)}))).apply(this,arguments)}var mt=function(){var t=o(a().mark(function t(e,r,n,i,u,c,s){var f,l,p,h,y;return a().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:f=s,l=[],p=a().mark(function t(){var n,s,p,y;return a().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=(r+h)*u,s="".concat(i,"&resultOffset=").concat(n),dt.logTrace("Creating request",{batch:e+1,offset:n,url:s}),p=new st(1),y=fetch(s).then(function(t){return t.json()}).then(function(){var t=o(a().mark(function t(e){var r;return a().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.features.length,t.next=1,p.withLock(function(){return f+=r,Promise.resolve()});case 1:return dt.logTrace("progress",{processed:f,total:c}),dt.sendMessage("info",{processed:f,total:c}),t.abrupt("return",e.features);case 2:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),l.push(y);case 1:case"end":return t.stop()}},t)}),h=0;case 1:if(!(h<n-r)){t.next=3;break}return t.delegateYield(p(),"t0",2);case 2:h++,t.next=1;break;case 3:return t.next=4,Promise.all(l);case 4:return y=t.sent,t.abrupt("return",{features:y.flat(),processedCount:f});case 5:case"end":return t.stop()}},t)}));return function(e,r,n,o,i,a,u){return t.apply(this,arguments)}}();function gt(){return(gt=o(a().mark(function t(r){var n,o,i,u,c,s,f,l,p,h,y,v,d,b,m,g;return a().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=r.maxRecordCount>1e4?1e4:r.maxRecordCount,o=Math.min(10,2*navigator.hardwareConcurrency),i="".concat(r.url,"/query?where=1=1&outFields=*&f=json&returnGeometry=").concat(r.queryGeometry,"&resultRecordCount=").concat(n),t.prev=1,dt.sendMessage("info",{processed:0,total:0}),u="".concat(r.url,"/query?where=1=1&returnCountOnly=true&f=json"),t.next=2,X(u);case 2:c=t.sent,s=c.count,dt.logTrace("Total features count:",s),f=Math.ceil(s/n),l=Math.ceil(f/o),p=[],h=0,y=0;case 3:if(!(y<l)){t.next=7;break}return v=y*o,d=Math.min((y+1)*o,f),t.next=4,mt(y,v,d,i,n,s,h);case 4:return b=t.sent,t.next=5,new Promise(function(t){setTimeout(t,1e3)});case 5:h=b.processedCount,p=[].concat(e(p),e(b.features));case 6:y++,t.next=3;break;case 7:return m={features:p,count:s},t.abrupt("return",m);case 8:throw t.prev=8,g=t.catch(1),dt.logError("Error in queryAllEsriFeatures",g),dt.sendMessage("error"),g;case 9:case"end":return t.stop()}},t,null,[[1,8]])}))).apply(this,arguments)}v({init:function(){try{dt.logTrace("FetchEsriWorker initialized")}catch(t){dt.logError("FetchEsriWorker failed to initialize",t)}},process:function(t){try{dt.logTrace("Starting query processing",JSON.stringify(t));var e="all"===t.objectIds?function(t){return gt.apply(this,arguments)}(t):function(t){return bt.apply(this,arguments)}(t);return e}catch(t){throw dt.logError("Query processing failed",t),t}}})})()})();
//# sourceMappingURL=fetch-esri-worker-script.worker.js.map