<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title><%= htmlWebpackPlugin.options.title %></title>
    <link rel="shortcut icon" href="./favicon.ico" />
    <meta name="msapplication-TileColor" content="#da532c" />
    <meta name="msapplication-config" content="./img/browserconfig.xml" />
    <meta name="theme-color" content="#ffffff" />
    <meta name="msapplication-TileColor" content="#da532c" />
    <meta name="theme-color" content="#ffffff" />
    <link href="https://fonts.googleapis.com/css?family=Roboto|Montserrat:200,300,400,900|Merriweather" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" />
    <link rel="stylesheet" href="css/style.css" />
  </head>
  <body>
    <div class="header-table">
      <table>
        <tbody>
          <tr>
            <td><img class="header-logo" alt="logo" src="./img/Logo.png" /></td>
            <td class="header-title">
              <h1><strong>UI Components</strong></h1>
            </td>
          </tr>
        </tbody>
      </table>
      <table>
        <tbody>
          <tr>
            <td>
              <a href="../index.html">Main</a><br />
              <a href="#SLIDER">1. Slider MUI Component</a><br />
            </td>
          </tr>
        </tbody>
      </table>
      <table>
        <tbody>
          <tr>
            <td>This page is used to showcase different Core UI components</td>
          </tr>
        </tbody>
      </table>
    </div>
    <div>
      <h3 id="SLIDER">1. Slider MUI Component</h3>
      <h3><a href="#top">Top of the page</a></h3>
      <div
        id="UI1"
        class="llwp-map"
        data-lang="en-CA"
        data-config="{
          'map': {
            'interaction': 'dynamic',
            'initialView': {
              'zoom': 4,
              'center': [60, -100]
            },
            'projection': 3857,
            'basemapOptions': {
              'id': 'transport',
              'shaded': false,
              'labeled': true
            }
          },
          'theme': 'dark',
          'languages': ['en-CA']
        }"
      ></div>
    </div>

    <!-- SLIDER SECTION START -->
    <div id="UI1-slider1" class="Panel" style="padding-top: 40px; width: 75%; padding-left: 25%;"></div>
    <div class="toolbar">
      <button type="button" id="sliderminmax">Set Slider Min/Max</button>
      <button type="button" id="slidervalues">Set Slider Values</button>
    </div>
    <div class="panel">
      <h3>Accessing slider value from outside of the core viewer using api event listeners</h3>
      <div class="slider-position1"></div>
    </div>
    <div id="UI1-slider2" class="Panel" style="padding-top: 40px; width: 50%; padding-left: 25%;"></div>
    <div class="panel">
      <h3>Accessing slider value from outside of the core viewer using api event listeners</h3>
      <div class="slider-position2"></div>
    </div>
    <!-- SLIDER SECTION END -->

    <script src="codedoc.js"></script>
    <script>
      // initialize cgpv and api events, a callback is optional, used if calling api's after the rendering is ready
      cgpv.init(function () {
        console.log('api is ready');

        /**
         * SLIDER UI SECTION START
         */
        // set min max
        function setSliderMinMax() {
          cgpv.api.event.emit(
            // TODO: add the ability to bypass the MAP ID (should be assign to the UI component ID)
            cgpv.types.sliderPayload(cgpv.api.eventNames.SLIDER.EVENT_SLIDER_SET_MINMAX, 'UI1-slider1', { min: 2, max: 16 })
          );
        }
        document.getElementById ("sliderminmax").addEventListener ("click", setSliderMinMax, false);

        // set values
        function setSliderValues() {
          cgpv.api.event.emit(
            // TODO: add the ability to bypass the MAP ID (should be assign to the UI component ID)
            cgpv.types.sliderPayload(cgpv.api.eventNames.SLIDER.EVENT_SLIDER_SET_VALUES, 'UI1-slider1', { value: 8 })
          );
        }
        document.getElementById ("slidervalues").addEventListener ("click", setSliderValues, false);

        // listen to slider value change event
        const sliderPosition1 = document.getElementsByClassName('slider-position1');
        cgpv.api.event.on(
          cgpv.api.eventNames.SLIDER.EVENT_SLIDER_CHANGE,
          (payload) => {
            if (cgpv.types.payloadIsASlider(payload)) {
              sliderPosition1[0].innerHTML = `<p>Slider ${payload.handlerName} with min ${payload.sliderValues.min}, max ${payload.sliderValues.max} and value ${payload.sliderValues.value}</p>`;
            }
          },
          'UI1-slider1'
        );

        // add a slider component and link it to a map with mapId props
        cgpv.api.addUiComponent('UI1-slider1', cgpv.react.createElement(cgpv.ui.elements.Slider,
          {
            mapId: 'UI1',
            id: 'UI1-slider1',
            min:0,
            max:18,
            value:5,
            marks: [{ value: 0, label: 'Min Level 0'}, {value: 4, label: 'Level 4'}, {value: 8, label: 'Level 8'}, {value: 18, label: 'Max Level 18'}],
            track: false,
            customOnChange: (zoomLevel) => { const lat = 50; const lng = -95; cgpv.api.map('UI1').map.setView([lat, lng], zoomLevel) }
          })
        );

        // listen to slider value change event
        const sliderPosition2 = document.getElementsByClassName('slider-position2');
        cgpv.api.event.on(
          cgpv.api.eventNames.SLIDER.EVENT_SLIDER_CHANGE,
          (payload) => {
            if (cgpv.types.payloadIsASlider(payload)) {
              sliderPosition2[0].innerHTML = `<p>Slider min ${payload.sliderValues.min}, max ${payload.sliderValues.max}, values ${payload.sliderValues.value} and active thumb ${payload.sliderValues.activeThumb === 0 ? 'left' : 'right'}</p>`;
            }
          },
          'UI1-slider2'
        );

        // add a slider component and DO NOT link it to a map
        cgpv.api.addUiComponent('UI1-slider2', cgpv.react.createElement(cgpv.ui.elements.Slider,
          {
            id: 'UI1-slider2',
            min:0,
            max:18,
            value:[5, 10],
            marks: [{ value: 0, label: 'Min Level 0'}, {value: 2}, {value: 4, label: 'Level 4'}, {value: 5, label: 'Level 5'}, {value: 6, label: 'Level 6'}, {value: 8, label: 'Level 8'}, {value: 18, label: 'Max Level 18'}],
          })
        );
        /**
         * SLIDER UI SECTION END
         */
      });
    </script>
  </body>
</html>
