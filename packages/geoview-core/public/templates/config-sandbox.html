<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>
    <%= htmlWebpackPlugin.options.title %>
  </title>
  <link rel="shortcut icon" href="./favicon.ico" />
  <meta name="msapplication-TileColor" content="#da532c" />
  <meta name="msapplication-config" content="./img/browserconfig.xml" />
  <meta name="theme-color" content="#ffffff" />
  <meta name="msapplication-TileColor" content="#da532c" />
  <meta name="theme-color" content="#ffffff" />
  <link rel="stylesheet" href="css/style.css" />

  <style>
    .editor {
      display: inline-flex;
      gap: 10px;
      font-family: monospace;
      line-height: 21px;
      background: #282a3a;
      border-radius: 2px;
      padding: 20px 10px;
      height: 500px;
      overflow-y: auto;
    }

    .line-numbers {
      width: 20px;
      text-align: right;
      height: 9999px;
    }

    .line-numbers span {
      counter-increment: linenumber;
    }

    .line-numbers span::before {
      content: counter(linenumber);
      display: block;
      color: #506882;
    }

    textarea {
      height: 9999px;
      line-height: 21px;
      overflow-y: hidden;
      padding: 0;
      border: 0;
      background: #282a3a;
      color: #fff;
      min-width: 500px;
      outline: none;
      resize: none;
    }
  </style>
</head>

<body>
  <div class="header-table">
    <table>
      <tbody>
        <tr>
          <td><img class="header-logo" alt="logo" src="./img/Logo.png" /></td>
          <td class="header-title">
            <h1><strong>Sandbox Configuration</strong></h1>
          </td>
        </tr>
      </tbody>
    </table>
    <table>
      <tbody>
        <tr>
          <td><a href="./index.html">Main</a><br /></td>
        </tr>
      </tbody>
    </table>
    <table>
      <tbody>
        <tr>
          <td>This page is used to test map configuration.</td>
        </tr>
        <tr>
          <td>
            Select a snippet:
            <select id="config-snippet">
              <option value="simple">Simple</option>
              <option value="uniqueValue">Unique value</option>
              <option value="classBreaks">Class breaks</option>
            </select>
          </td>
        </tr>
      </tbody>
    </table>
    <table>
      <tbody>
        <tr>
          <td>
            <div class="editor">
              <div class="line-numbers" id="inputLineNumbers">
                <span></span>
              </div>
              <textarea id="configGeoview" name="configuration" cols="110">
              </textarea>
            </div>
          </td>
          <td>
            <span id="validationMessage" style="margin:10px;">File not validated...</span>
            <div class="editor">
              <div class="line-numbers" id="outputLineNumbers">
                <span></span>
              </div>
              <textarea id="configOutput" name="configuration" cols="110">
              </textarea>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
  <div>
    <button id="validateConfig" style="margin:10px;">Validate</button>
    <select id="language">
      <option value="en">English</option>
      <option value="fr">Français</option>
    </select>
    <button id="createMap" style="margin:10px;">Create Map</button>
    <button id="deleteMap" style="margin:10px;">Delete map</button>
    <br />
  </div>
  <div class="editor" style="height:60px">
    <div class="line-numbers" id="inputLineNumbers">
      <span></span>
    </div>
    <div>
      <textarea id="configUrlGeoview" name="Urlconfiguration" cols="210">
p=3857&z=4&c=-100,40&l=en&t=dark&b=basemapId:transport,shaded:false,labeled:true&i=dynamic&cc=overview-map&keys=12acd145-626a-49eb-b850-0a59c9bc7506,ccc75c12-5acc-4a6a-959f-ef6f621147b9
      </textarea>
    </div>
  </div>
  <div>
    <button id="validateUrlConfig" style="margin:10px;">Validate</button>
    <select id="urlLanguage">
      <option value="en">English</option>
      <option value="fr">Français</option>
    </select>
    <br />
  </div>
  <div class="map-title-holder">
    <h4 id="HLCONF1">Sanbox Map</h4>
    <a class="ref-link" href="#top">Top</a>
  </div>
  <div id="mapSection">
    <div id="sandboxMap"></div>
  </div>
  <p>This map loads it's configurations from the text area.</p>
  <hr />

  <button type="button" class="collapsible">Code Snippet</button>
  <pre id="codeSnippet" class="panel"></pre>

  <script src="codedoc.js"></script>

  <script>
    const simpleSnippet = `{
  'map': {
    'interaction': 'dynamic',
    'viewSettings': {
      'minZoom': 5,
      'projection': 3978
    },
    'basemapOptions': {
      'basemapId': 'transport',
      'shaded': false,
      'labeled': true
    },
    'listOfGeoviewLayerConfig': [
      {
        'geoviewLayerId': 'LYR1',
        'geoviewLayerName': {
          'en': 'Temporal Test Bed',
          'fr': 'Banc d\\'essai temporel'
        },
        'metadataAccessPath': {
          'en': 'https://maps-cartes.services.geo.ca/server_serveur/rest/services/NRCan/Temporal_Test_Bed_en/MapServer/',
          'fr': 'https://maps-cartes.services.geo.ca/server_serveur/rest/services/NRCan/Temporal_Test_Bed_fr/MapServer/'
        },
        'geoviewLayerType': 'esriFeature',
        'listOfLayerEntryConfig': [
          {
            'layerId': '0',
            'geometryType': 'point',
            'layerName': {
              'en': 'stations-Temporal',
              'fr': 'stations-Temporal'
            },
            'initialSettings': {
              'controls': {
                'query': true
              },
              'states': {
                'queryable': true
              }
            },
            'attributions': [],
            'temporalDimension': {
              'field': 'Date',
              'default': '2021-09-01T00:00:00Z',
              'unitSymbol': '',
              'range': {
                'range': [
                  '2020-01-01T00:00:00Z',
                  '2020-03-01T00:00:00Z',
                  '2020-05-01T00:00:00Z',
                  '2020-07-01T00:00:00Z',
                  '2020-09-01T00:00:00Z',
                  '2020-11-01T00:00:00Z',
                  '2021-01-01T00:00:00Z',
                  '2021-03-01T00:00:00Z',
                  '2021-05-01T00:00:00Z',
                  '2021-07-01T00:00:00Z',
                  '2021-09-01T00:00:00Z'
                ],
                'type': 'discrete'
              },
              'singleHandle': false
            },
            'source': {
              'layerFilter': '',
              'maxRecordCount': 0,
              'featureInfo': {
                'nameField': 'Location_Emplacement',
                'outfields': [
                  {
                    'name': 'Location_Emplacement',
                    'alias': 'Location_Emplacement',
                    'type': 'string',
                    'domain': []
                  },
                  {
                    'name': 'Province',
                    'alias': 'Province',
                    'type': 'string',
                    'domain': []
                  },
                  {
                    'name': 'Station',
                    'alias': 'Station',
                    'type': 'string',
                    'domain': []
                  },
                  {
                    'name': 'OBJECTID',
                    'alias': 'OBJECTID',
                    'type': 'number',
                    'domain': []
                  },
                  {
                    'name': 'X',
                    'alias': 'X',
                    'type': 'number',
                    'domain': []
                  },
                  {
                    'name': 'Y',
                    'alias': 'Y',
                    'type': 'number',
                    'domain': []
                  },
                  {
                    'name': 'Status_EN',
                    'alias': 'Status_EN',
                    'type': 'string',
                    'domain': []
                  },
                  {
                    'name': 'Status_FR',
                    'alias': 'Status_FR',
                    'type': 'string',
                    'domain': []
                  },
                  {
                    'name': 'Date',
                    'alias': 'Date',
                    'type': 'date',
                    'domain': []
                  }
                ]
              }
            },
            'style': {
              'type': 'simple',
              'hasDefault': false,
              'info': [
                {
                  'label': '',
                  'visible': true,
                  'settings': {
                    'type': 'simpleSymbol',
                    'symbol': 'circle',
                    'stroke': {
                      'color': 'rgba(0,0,0,1)',
                      'lineStyle': 'solid',
                      'width': 1
                    },
                    'size': 2.668,
                    'rotation': 0,
                    'offset': [0,0],
                    'color': 'rgba(0,156,130,1)'
                  }
                }
              ]
            }
          }
        ]
      }
    ]
  },
  'components': ['overview-map'],
  'footerBar': {
    'tabs': {
      'core': ['legend', 'layers', 'details', 'data-table']
    }
  },
  'corePackages': [],
  'theme': 'geo.ca'
}
`;
    const uniqueValueSnippet = `{
  'map': {
    'interaction': 'dynamic',
    'viewSettings': {
      'minZoom': 5,
      'projection': 3978
    },
    'basemapOptions': {
      'basemapId': 'transport',
      'shaded': false,
      'labeled': true
    },
    'listOfGeoviewLayerConfig': [
      {
        'geoviewLayerId': 'LYR1',
        'geoviewLayerName': {
          'en': 'Earthquakes',
          'fr': 'Tremblements de terre'
        },
        'metadataAccessPath': {
          'en': 'https://maps-cartes.services.geo.ca/server_serveur/rest/services/NRCan/earthquakes_en/MapServer/',
          'fr': 'https://maps-cartes.services.geo.ca/server_serveur/rest/services/NRCan/earthquakes_fr/MapServer/'
        },
        'geoviewLayerType': 'esriDynamic',
        'listOfLayerEntryConfig': [
          {
            'layerId': '0',
            'geometryType': 'point',
            'layerName': {
              'en': 'Earthquakes 1980-1990',
              'fr': 'Tremblements de terre 1980-1990'
            },
            'initialSettings': {
              'controls': {
                'query': true
              },
              'states': {
                'queryable': true
              }
            },
            'attributions': ['Ressources naturelles Canada, Secteur des terres et des minéraux, Commission Géologique du Canada, Service canadien d\\'information sur les risques'],
            'source': {
              'layerFilter': '',
              'maxRecordCount': 0,
              'featureInfo': {
                'nameField': 'date',
                'outfields': [
                  {
                    'name': 'magnitude_codelist',
                    'alias': 'magnitude_codelist',
                    'type': 'string',
                    'domain': []
                  },
                  {
                    'name': 'magnitude',
                    'alias': 'Magnitude',
                    'type': 'number',
                    'domain': []
                  },
                  {
                    'name': 'magnitude_type',
                    'alias': 'Magnitude Type',
                    'type': 'string',
                    'domain': []
                  },
                  {
                    'name': 'date',
                    'alias': 'Date',
                    'type': 'string',
                    'domain': []
                  },
                  {
                    'name': 'place',
                    'alias': 'Place',
                    'type': 'string',
                    'domain': []
                  },
                  {
                    'name': 'depth',
                    'alias': 'Depth',
                    'type': 'number',
                    'domain': []
                  },
                  {
                    'name': 'latitude',
                    'alias': 'Latitude',
                    'type': 'number',
                    'domain': []
                  },
                  {
                    'name': 'longitude',
                    'alias': 'Longitude',
                    'type': 'number',
                    'domain': []
                  },
                  {
                    'name': 'OBJECTID',
                    'alias': 'OBJECTID',
                    'type': 'number',
                    'domain': []
                  }
                ]
              }
            },
            'style': {
              'type': 'uniqueValue',
              'fields': ['magnitude_codelist'],
              'hasDefault': false,
              'info': [
                {
                  'label': 'Magnitude less than 2',
                  'visible': true,
                  'values': ['\<2'],
                  'settings': {
                    'type': 'simpleSymbol',
                    'symbol': 'circle',
                    'stroke': {
                      'color': 'rgba(0,0,0,1)',
                      'lineStyle': 'solid',
                      'width': 1
                    },
                    'size': 3.335,
                    'rotation': 0,
                    'offset': [0,0],
                    'color': 'rgba(30,0,120,1)'
                  }
                },
                {
                  'label': '2 to \<3',
                  'visible': true,
                  'values': ['2'],
                  'settings': {
                    'type': 'simpleSymbol',
                    'symbol': 'circle',
                    'stroke': {
                      'color': 'rgba(0,0,0,1)',
                      'lineStyle': 'solid',
                      'width': 1
                    },
                    'size': 4.669,
                    'rotation': 0,
                    'offset': [0,0],
                    'color': 'rgba(120,0,190,1)'
                  }
                },
                {
                  'label': '3 to \<4',
                  'visible': true,
                  'values': ['3'],
                  'settings': {
                    'type': 'simpleSymbol',
                    'symbol': 'circle',
                    'stroke': {
                      'color': 'rgba(0,0,0,1)',
                      'lineStyle': 'solid',
                      'width': 1
                    },
                    'size': 6.003,
                    'rotation': 0,
                    'offset': [0,0],
                    'color': 'rgba(190,0,120,1)'
                  }
                },
                {
                  'label': '4 to \<5',
                  'visible': true,
                  'values': ['4'],
                  'settings': {
                    'type': 'simpleSymbol',
                    'symbol': 'circle',
                    'stroke': {
                      'color': 'rgba(0,0,0,1)',
                      'lineStyle': 'solid',
                      'width': 1
                    },
                    'size': 7.337,
                    'rotation': 0,
                    'offset': [0,0],
                    'color': 'rgba(255,0,0,1)'
                  }
                },
                {
                  'label': '5 to \<6',
                  'visible': true,
                  'values': ['5'],
                  'settings': {
                    'mimeType': 'image/png',
                    'offset': [0,0],
                    'opacity': 1,
                    'rotation': 0,
                    'src': 'iVBORw0KGgoAAAANSUhEUgAAACIAAAAfCAYAAACCox+xAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAA2VJREFUWIXNl39o1GUcx1+3W3uM0209tmBudguuLV0/RqVX80fUDKtp5s5JfyxYQaChkMQSKopZgjRBCO0HFAlSf0y04mwykAnGzKMfiDFo7vrjqHEj9ZOODvx4eeuP79du2u685Zdd73+e5/l8P5/P84Ln+XwevqX8T1TqQY4Sd8wUFcQYsxSYUNVvigoCRIAJoKggPlVtc0G2uOPMg1hrwyJS684Xi0isKCCpVGrdNfPigARUI00GzsPlYdUI0DXjINbaB0Sk7sUFkE7DxiHusNbeLyI/zihIKpWKAISrIAN+hv6xzSyIVW2fZ6ChHDIZCEJmzCnl170AsWQ7ZU4ZY+qTqqHuENxU4kRsaYCXh7XBGNOsqqcL2DsDSC6Qh4C9QFW+DKoKwMPzsrZlNZQwDKo6WADEGaAT6MsF0gfcZ2CfQgvAeguPVv87kw+oL8+uF1TAB41T7zqQhP2SXQIdQHKyz1R3JKnwOLDVwDu9gv/ZO+HpWvDnObSbS2HDwqttf2Ug+psDYeCywpvADqZ4IHNd1glgR8Dao3XI/rYY87vGYOu9MHdWbpjJOnsR3j0FPQkIweivxrSj+m0u/7xVIyIxgbub4OOeBO3HxmD3Enhwbn6I78/BhkH4QSEIX8ThBVTP54sppHzHTzpX5flz8OGiAcoONUNrzdTOX4/CquMQhDSwOQEfFbBH4X1E4FNRaoFtFf7cfpXutwS8TYEQ0wJx9RTAPTZruPLu+9xx0reVODCeg9QA4deCUFHmGP68BHt+duYv3QVzyqC8DN4KQXecZqCaa8rUC5A2wLfidmcxMg5d38FXbn8YPAM7Fzm9paUauuP4gLXA+16DRAAaKyE6Cu3HIQCZkGHbYsvso0leaejHdzAMy2+7KsZTkCpg6UoL752C7QlYZvh9KGDXxEVOxJMQNubLpoAeaotR2RWEiIUDwiPArcBZr0CeAfz9Av0CTxqih5UOVMavOMRUB1HqOi0HehLO8wD4gTXAJ16BOMdiSM8OsPGw5Ex8Ya+w4jnLpp9S7DqplLqxnoBUAo+ttvwSFZ5AiV8vYJ+wG+hfbznSK7QAFcCFGwVpNcbsioq+gdMtC9VIrxAyxmxX1Vbg8xsF6VPVz6YBMFlpVX0VuOV6joWA/PEfIaaVw4tfTk/0N13QHet8ojHFAAAAAElFTkSuQmCC',
                    'type': 'iconSymbol'
                  }
                },
                {
                  'label': '\> or equal to 6',
                  'visible': true,
                  'values': ['\>=6'],
                  'settings': {
                    'mimeType': 'image/png',
                    'offset': [0,0],
                    'opacity': 1,
                    'rotation': 0,
                    'src': 'iVBORw0KGgoAAAANSUhEUgAAACcAAAAkCAYAAAAKNyObAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAABD5JREFUWIXNmH1MVXUYxz/AlR8vl7KjLQ9UYKC1rhOQTYyZBcEgyRgvTjC3NplBL+KWtaKJvdl6maswX0bmS3PDWOVGRNPRbEot19LR5p22qHZb7thWJ1+4xcPLpT/OvSAGlwscBt9/zjnP+T3f3+fe5/xeznEwg+WYboBgshuuFPjULjM74WYD7wHNQJ8dhnbCPQzoSqn7ReRLOwxtg3PpVLgNEJFSYEbBxZkmuf7zYuBJwDdZU7vgHjJk0OsWpdRyETk5WVNb4AIlTVTgERCRMmBGwMV2meQDNFRBwQ4ASoBNwMBkjO2Ae9AjRFZmQY4L7k2Edg8JmqZlmqZ5alrhAiUtTgdHBDy6AtoPgdfrLQOmFS5KhEKA9CQrsCzZOopICfDMZMyvh7sRCAPwvKGWRDgkJljy52fU0upGUZVZoN9kxRbMgzQdOgzmNz+l1WQkmb8E8+jpVX/fUStu/2U/cHU0uPuA/cCcxOdljN8FYLUpTh+KzHLAY9nwRCMU7TTrQ/UAfldKrRORE6PBfQakAoeA7BDogKGSBpSVEmrmsH7Xi8hf1wZHeuYuALlALfAS4MhP4creDcTdOscq+VhafDv4Phj53k8X6Vu7i+7TBk6sv+1ZrA3D/zTagPABrymljotI47FOkhY8h6+5hp68Raiw8FAQh6vfB0e+p2vN+zgBp1LqfGxsbLlpmj+MlhN0tIrIt0Aa0CCwpmAHamsh/2zOJyYu6FAZLvMq1B2ha087Tn/ogIhsFBFvsLxQppLLQDnQBtS/0krsV2fp2VtJ5ML4sZPP/Arle+jtNHECV4Bq4HAI/Y5rntsHfA181O4h7a6tcKoWliaPnnC0A1buBGAW8B1QAQSdWiYKB/AjcI+mME0h+oao4I1n+4uoKy4YwnKgdzydjXuFUEotMUWiM3VImRe87aIEUIAhJADxgGdK4bBeYlifY62lAXm74eR5yL4boiKtmDMa6lbBlhbA2qm8M6VwKZqUu42hNRTg5z+g6gByvBO1NoP+11cTcdtc6162C2gBTbHalCmE0zQtw22Y8XdqsFAHnw9aO+gr2k0EVgV9jaeJOHqWgaZqwnJcQ6U1hWWADhhTAuf1eksAHs+FfwXqWune3kZgWOwDXgbeNYWSvHrYtoqBjXmEvVAIL7YShvV+sXtK4FI0qXAb4BuAnDfp6zCIAi4BG4BP/M1KgSrg7S0txJw4hy8vlXAYLK39cLquu9yGMR/g6Y8Hc9uBdcBv1zVvwHqHONzWSWpbpxX0CiuAucCftsIZhlF6zWU/8CqwzX8+ks4BmUqpt0SkBkAgHCjCegTsg8M/hQAepdQjIvJNCDkiIpuAY8BB4GagzG64ZGAx0ARUicjlEPMC+sKf/yHwANZ3lUt2weUDlVi75InqIlAAbPb7NY2VECrcfqB74lyDGgC2A2OsypZChbMDbNx+M/rL5n+qSli//HCkMAAAAABJRU5ErkJggg==',
                    'type': 'iconSymbol'
                  }
                }
              ]
            }
          },
          {
            'layerId': '1',
            'geometryType': 'point',
            'layerName': {
              'en': 'Earthquakes 1990-2000',
              'fr': ' Tremblements de terre 1990-2000'
            },
            'attributions': ['Ressources naturelles Canada, Secteur des terres et des minéraux, Commission Géologique du Canada, Service canadien d\\'information sur les risques'],
            'source': {
              'layerFilter': '',
              'maxRecordCount': 0,
              'featureInfo': {
                'nameField': 'date',
                'outfields': [
                  {
                    'name': 'magnitude_codelist',
                    'alias': 'magnitude_codelist',
                    'type': 'date',
                    'domain': []
                  },
                  {
                    'name': 'magnitude',
                    'alias': 'Magnitude',
                    'type': 'number',
                    'domain': []
                  },
                  {
                    'name': 'magnitude_type',
                    'alias': 'Magnitude Type',
                    'type': 'string',
                    'domain': []
                  },
                  {
                    'name': 'date',
                    'alias': 'Date',
                    'type': 'string',
                    'domain': []
                  },
                  {
                    'name': 'place',
                    'alias': 'Place',
                    'type': 'string',
                    'domain': []
                  },
                  {
                    'name': 'depth',
                    'alias': 'Depth',
                    'type': 'number',
                    'domain': []
                  },
                  {
                    'name': 'latitude',
                    'alias': 'Latitude',
                    'type': 'number',
                    'domain': []
                  },
                  {
                    'name': 'longitude',
                    'alias': 'Longitude',
                    'type': 'number',
                    'domain': []
                  },
                  {
                    'name': 'OBJECTID',
                    'alias': 'OBJECTID',
                    'type': 'number',
                    'domain': []
                  }
                ]
              }
            },
            'style': {
              'type': 'uniqueValue',
              'fields': ['magnitude_codelist'],
              'hasDefault': false,
              'info': [
                {
                  'label': 'Magnitude less than 2',
                  'visible': true,
                  'values': ['\<2'],
                  'settings': {
                    'type': 'simpleSymbol',
                    'symbol': 'circle',
                    'stroke': {
                      'color': 'rgba(0,0,0,1)',
                      'lineStyle': 'solid',
                      'width': 1
                    },
                    'size': 3.335,
                    'rotation': 0,
                    'offset': [0,0],
                    'color': 'rgba(30,0,120,1)'
                  }
                },
                {
                  'label': '2 to \<3',
                  'visible': true,
                  'values': ['2'],
                  'settings': {
                    'type': 'simpleSymbol',
                    'symbol': 'circle',
                    'stroke': {
                      'color': 'rgba(0,0,0,1)',
                      'lineStyle': 'solid',
                      'width': 1
                    },
                    'size': 4.669,
                    'rotation': 0,
                    'offset': [0,0],
                    'color': 'rgba(120,0,190,1)'
                  }
                },
                {
                  'label': '3 to \<4',
                  'visible': true,
                  'values': ['3'],
                  'settings': {
                    'type': 'simpleSymbol',
                    'symbol': 'circle',
                    'stroke': {
                      'color': 'rgba(0,0,0,1)',
                      'lineStyle': 'solid',
                      'width': 1
                    },
                    'size': 6.003,
                    'rotation': 0,
                    'offset': [0,0],
                    'color': 'rgba(190,0,120,1)'
                  }
                },
                {
                  'label': '4 to \<5',
                  'visible': true,
                  'values': ['4'],
                  'settings': {
                    'type': 'simpleSymbol',
                    'symbol': 'circle',
                    'stroke': {
                      'color': 'rgba(0,0,0,1)',
                      'lineStyle': 'solid',
                      'width': 1
                    },
                    'size': 7.337,
                    'rotation': 0,
                    'offset': [0,0],
                    'color': 'rgba(255,0,0,1)'
                  }
                },
                {
                  'label': '5 to \<6',
                  'visible': true,
                  'values': ['5'],
                  'settings': {
                    'mimeType': 'image/png',
                    'offset': [0,0],
                    'opacity': 1,
                    'rotation': 0,
                    'src': 'iVBORw0KGgoAAAANSUhEUgAAACIAAAAfCAYAAACCox+xAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAA2VJREFUWIXNl39o1GUcx1+3W3uM0209tmBudguuLV0/RqVX80fUDKtp5s5JfyxYQaChkMQSKopZgjRBCO0HFAlSf0y04mwykAnGzKMfiDFo7vrjqHEj9ZOODvx4eeuP79du2u685Zdd73+e5/l8P5/P84Ln+XwevqX8T1TqQY4Sd8wUFcQYsxSYUNVvigoCRIAJoKggPlVtc0G2uOPMg1hrwyJS684Xi0isKCCpVGrdNfPigARUI00GzsPlYdUI0DXjINbaB0Sk7sUFkE7DxiHusNbeLyI/zihIKpWKAISrIAN+hv6xzSyIVW2fZ6ChHDIZCEJmzCnl170AsWQ7ZU4ZY+qTqqHuENxU4kRsaYCXh7XBGNOsqqcL2DsDSC6Qh4C9QFW+DKoKwMPzsrZlNZQwDKo6WADEGaAT6MsF0gfcZ2CfQgvAeguPVv87kw+oL8+uF1TAB41T7zqQhP2SXQIdQHKyz1R3JKnwOLDVwDu9gv/ZO+HpWvDnObSbS2HDwqttf2Ug+psDYeCywpvADqZ4IHNd1glgR8Dao3XI/rYY87vGYOu9MHdWbpjJOnsR3j0FPQkIweivxrSj+m0u/7xVIyIxgbub4OOeBO3HxmD3Enhwbn6I78/BhkH4QSEIX8ThBVTP54sppHzHTzpX5flz8OGiAcoONUNrzdTOX4/CquMQhDSwOQEfFbBH4X1E4FNRaoFtFf7cfpXutwS8TYEQ0wJx9RTAPTZruPLu+9xx0reVODCeg9QA4deCUFHmGP68BHt+duYv3QVzyqC8DN4KQXecZqCaa8rUC5A2wLfidmcxMg5d38FXbn8YPAM7Fzm9paUauuP4gLXA+16DRAAaKyE6Cu3HIQCZkGHbYsvso0leaejHdzAMy2+7KsZTkCpg6UoL752C7QlYZvh9KGDXxEVOxJMQNubLpoAeaotR2RWEiIUDwiPArcBZr0CeAfz9Av0CTxqih5UOVMavOMRUB1HqOi0HehLO8wD4gTXAJ16BOMdiSM8OsPGw5Ex8Ya+w4jnLpp9S7DqplLqxnoBUAo+ttvwSFZ5AiV8vYJ+wG+hfbznSK7QAFcCFGwVpNcbsioq+gdMtC9VIrxAyxmxX1Vbg8xsF6VPVz6YBMFlpVX0VuOV6joWA/PEfIaaVw4tfTk/0N13QHet8ojHFAAAAAElFTkSuQmCC',
                    'type': 'iconSymbol'
                  }
                },
                {
                  'label': '\> or equal to 6',
                  'visible': true,
                  'values': ['\>=6'],
                  'settings': {
                    'mimeType': 'image/png',
                    'offset': [0,0],
                    'opacity': 1,
                    'rotation': 0,
                    'src': 'iVBORw0KGgoAAAANSUhEUgAAACcAAAAkCAYAAAAKNyObAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAABD5JREFUWIXNmH1MVXUYxz/AlR8vl7KjLQ9UYKC1rhOQTYyZBcEgyRgvTjC3NplBL+KWtaKJvdl6maswX0bmS3PDWOVGRNPRbEot19LR5p22qHZb7thWJ1+4xcPLpT/OvSAGlwscBt9/zjnP+T3f3+fe5/xeznEwg+WYboBgshuuFPjULjM74WYD7wHNQJ8dhnbCPQzoSqn7ReRLOwxtg3PpVLgNEJFSYEbBxZkmuf7zYuBJwDdZU7vgHjJk0OsWpdRyETk5WVNb4AIlTVTgERCRMmBGwMV2meQDNFRBwQ4ASoBNwMBkjO2Ae9AjRFZmQY4L7k2Edg8JmqZlmqZ5alrhAiUtTgdHBDy6AtoPgdfrLQOmFS5KhEKA9CQrsCzZOopICfDMZMyvh7sRCAPwvKGWRDgkJljy52fU0upGUZVZoN9kxRbMgzQdOgzmNz+l1WQkmb8E8+jpVX/fUStu/2U/cHU0uPuA/cCcxOdljN8FYLUpTh+KzHLAY9nwRCMU7TTrQ/UAfldKrRORE6PBfQakAoeA7BDogKGSBpSVEmrmsH7Xi8hf1wZHeuYuALlALfAS4MhP4creDcTdOscq+VhafDv4Phj53k8X6Vu7i+7TBk6sv+1ZrA3D/zTagPABrymljotI47FOkhY8h6+5hp68Raiw8FAQh6vfB0e+p2vN+zgBp1LqfGxsbLlpmj+MlhN0tIrIt0Aa0CCwpmAHamsh/2zOJyYu6FAZLvMq1B2ha087Tn/ogIhsFBFvsLxQppLLQDnQBtS/0krsV2fp2VtJ5ML4sZPP/Arle+jtNHECV4Bq4HAI/Y5rntsHfA181O4h7a6tcKoWliaPnnC0A1buBGAW8B1QAQSdWiYKB/AjcI+mME0h+oao4I1n+4uoKy4YwnKgdzydjXuFUEotMUWiM3VImRe87aIEUIAhJADxgGdK4bBeYlifY62lAXm74eR5yL4boiKtmDMa6lbBlhbA2qm8M6VwKZqUu42hNRTg5z+g6gByvBO1NoP+11cTcdtc6162C2gBTbHalCmE0zQtw22Y8XdqsFAHnw9aO+gr2k0EVgV9jaeJOHqWgaZqwnJcQ6U1hWWADhhTAuf1eksAHs+FfwXqWune3kZgWOwDXgbeNYWSvHrYtoqBjXmEvVAIL7YShvV+sXtK4FI0qXAb4BuAnDfp6zCIAi4BG4BP/M1KgSrg7S0txJw4hy8vlXAYLK39cLquu9yGMR/g6Y8Hc9uBdcBv1zVvwHqHONzWSWpbpxX0CiuAucCftsIZhlF6zWU/8CqwzX8+ks4BmUqpt0SkBkAgHCjCegTsg8M/hQAepdQjIvJNCDkiIpuAY8BB4GagzG64ZGAx0ARUicjlEPMC+sKf/yHwANZ3lUt2weUDlVi75InqIlAAbPb7NY2VECrcfqB74lyDGgC2A2OsypZChbMDbNx+M/rL5n+qSli//HCkMAAAAABJRU5ErkJggg==',
                    'type': 'iconSymbol'
                  }
                }
              ]
            }
          }
        ]
      }
    ]
  },
  'components': ['overview-map'],
  'footerBar': {
    'tabs': {
      'core': ['legend', 'layers', 'details', 'data-table']
    }
  },
  'corePackages': [],
  'theme': 'geo.ca'
}
`;
    const classBreaksSnippet = `{
  'map': {
    'interaction': 'dynamic',
    'viewSettings': {
      'minZoom': 5,
      'projection': 3978
    },
    'basemapOptions': {
      'basemapId': 'transport',
      'shaded': false,
      'labeled': true
    },
    'listOfGeoviewLayerConfig': [
      {
        'geoviewLayerId': 'LYR1',
        'geoviewLayerName': {
          'en': 'ClassBreaks',
          'fr': 'ClassBreaks'
        },
        'metadataAccessPath': {
          'en': 'https://maps-cartes.ec.gc.ca/arcgis/rest/services/DMS/CSO_volume/MapServer/'
        },
        'geoviewLayerType': 'esriFeature',
        'listOfLayerEntryConfig': [
          {
            'layerId': '11',
            'geometryType': 'point',
            'layerName': {
              'en': '2021 Combined sewer overflow : total volume discharged - Watewater'
            },
            'initialSettings': {
              'controls': {
                'query': true
              },
              'states': {
                'queryable': true
              }
            },
            'attributions': ['Environment and Climate Change Canada and ministère de l’Environnement et de la Lutte contre les changements climatiques du Québec'],
            'source': {
              'layerFilter': '',
              'maxRecordCount': 0,
              'featureInfo': {
                'nameField': 'Owner',
                'outfields': [
                  {
                    'name': 'OBJECTID',
                    'alias': 'OBJECTID',
                    'type': 'number',
                    'domain': []
                  },
                  {
                    'name': 'Facility_id',
                    'alias': 'Facility Identification',
                    'type': 'number',
                    'domain': []
                  },
                  {
                    'name': 'Owner',
                    'alias': 'Owner Name',
                    'type': 'string',
                    'domain': []
                  },
                  {
                    'name': 'System',
                    'alias': 'System Name',
                    'type': 'string',
                    'domain': []
                  },
                  {
                    'name': 'City',
                    'alias': 'City',
                    'type': 'string',
                    'domain': []
                  },
                  {
                    'name': 'Province_EN',
                    'alias': 'Province',
                    'type': 'string',
                    'domain': []
                  },
                  {
                    'name': 'Latitude',
                    'alias': 'Latitude',
                    'type': 'number',
                    'domain': []
                  },
                  {
                    'name': 'Longitude',
                    'alias': 'Longitude',
                    'type': 'number',
                    'domain': []
                  },
                  {
                    'name': 'Approval_State',
                    'alias': 'Approval State',
                    'type': 'string',
                    'domain': []
                  },
                  {
                    'name': 'Jan_CSO_Discharge',
                    'alias': 'January - Was effluent discharged from a CSO points during month?',
                    'type': 'string',
                    'domain': []
                  },
                  {
                    'name': 'Jan_CSO_Volume',
                    'alias': 'January - Volume of effluent deposited via a CSO point in the month (m3),',
                    'type': 'number',
                    'domain': []
                  },
                  {
                    'name': 'Feb_CSO_Discharge',
                    'alias': 'February - Was effluent discharged from a CSO points during month?',
                    'type': 'string',
                    'domain': []
                  },
                  {
                    'name': 'Feb_CSO_Volume',
                    'alias': 'February - Volume of effluent deposited via a CSO point in the month (m3),',
                    'type': 'number',
                    'domain': []
                  },
                  {
                    'name': 'Mar_CSO_Discharge',
                    'alias': 'March - Was effluent discharged from a CSO points during month?',
                    'type': 'string',
                    'domain': []
                  },
                  {
                    'name': 'Mar_CSO_Volume',
                    'alias': 'March - Volume of effluent deposited via a CSO point in the month (m3)',
                    'type': 'number',
                    'domain': []
                  },
                  {
                    'name': 'Apr_CSO_Discharge',
                    'alias': 'April - Was effluent discharged from a CSO points during month?',
                    'type': 'string',
                    'domain': []
                  },
                  {
                    'name': 'Apr_CSO_Volume',
                    'alias': 'April - Volume of effluent deposited via a CSO point in the month (m3)',
                    'type': 'number',
                    'domain': []
                  },
                  {
                    'name': 'May_CSO_Discharge',
                    'alias': 'May - Was effluent discharged from a CSO points during month?',
                    'type': 'string',
                    'domain': []
                  },
                  {
                    'name': 'May_CSO_Volume',
                    'alias': 'May - Volume of effluent deposited via a CSO point in the month (m3)',
                    'type': 'number',
                    'domain': []
                  },
                  {
                    'name': 'Jun_CSO_Discharge',
                    'alias': 'June - Was effluent discharged from a CSO points during month?',
                    'type': 'string',
                    'domain': []
                  },
                  {
                    'name': 'Jun_CSO_Volume',
                    'alias': 'June - Volume of effluent deposited via a CSO point in the month (m3)',
                    'type': 'number',
                    'domain': []
                  },
                  {
                    'name': 'Jul_CSO_Discharge',
                    'alias': 'July - Was effluent discharged from a CSO points during month?',
                    'type': 'string',
                    'domain': []
                  },
                  {
                    'name': 'Jul_CSO_Volume',
                    'alias': 'July - Volume of effluent deposited via a CSO point in the month (m3)',
                    'type': 'number',
                    'domain': []
                  },
                  {
                    'name': 'Aug_CSO_Discharge',
                    'alias': 'August - Was effluent discharged from a CSO points during month?',
                    'type': 'string',
                    'domain': []
                  },
                  {
                    'name': 'Aug_CSO_Volume',
                    'alias': 'August - Volume of effluent deposited via a CSO point in the month (m3)',
                    'type': 'number',
                    'domain': []
                  },
                  {
                    'name': 'Sept_CSO_Discharge',
                    'alias': 'September - Was effluent discharged from a CSO points during month?',
                    'type': 'string',
                    'domain': []
                  },
                  {
                    'name': 'Sept_CSO_Volume',
                    'alias': 'September - Volume of effluent deposited via a CSO point in the month (m3)',
                    'type': 'number',
                    'domain': []
                  },
                  {
                    'name': 'Oct_CSO_Discharge',
                    'alias': 'October - Was effluent discharged from a CSO points during month?',
                    'type': 'string',
                    'domain': []
                  },
                  {
                    'name': 'Oct_CSO_Volume',
                    'alias': 'October - Volume of effluent deposited via a CSO point in the month (m3)',
                    'type': 'number',
                    'domain': []
                  },
                  {
                    'name': 'Nov_CSO_Discharge',
                    'alias': 'November - Was effluent discharged from a CSO points during month?',
                    'type': 'string',
                    'domain': []
                  },
                  {
                    'name': 'Nov_CSO_Volume',
                    'alias': 'November - Volume of effluent deposited via a CSO point in the month (m3)',
                    'type': 'number',
                    'domain': []
                  },
                  {
                    'name': 'Dec_CSO_Discharge',
                    'alias': 'December - Was effluent discharged from a CSO points during month?',
                    'type': 'string',
                    'domain': []
                  },
                  {
                    'name': 'Dec_CSO_Volume',
                    'alias': 'December - Volume of effluent deposited via a CSO point in the month (m3)',
                    'type': 'number',
                    'domain': []
                  },
                  {
                    'name': 'Total_CSO_Volume',
                    'alias': 'Total volume of effluent deposited via a CSO points',
                    'type': 'number',
                    'domain': []
                  }
                ]
              }
            },
            'style': {
              'type': 'classBreaks',
              'fields': ['Total_CSO_Volume'],
              'hasDefault': false,
              'info': [
                {
                  'label': '0 m3',
                  'values': [0,0],
                  'settings': {
                    'color': 'rgba(0,156,130,1)',
                    'offset': [0,0],
                    'rotation': 0,
                    'size': 4.002,
                    'stroke': {
                      'color': 'rgba(0,0,0,1)',
                      'lineStyle': 'solid',
                      'width': 0.5
                    },
                    'symbol': 'circle',
                    'type': 'simpleSymbol'
                  },
                  'visible': true
                },
                {
                  'label': '\>0 - 1,000 m3',
                  'values': [0,1000],
                  'settings': {
                    'color': 'rgba(232,190,255,1)',
                    'offset': [0,0],
                    'rotation': 0,
                    'size': 5.336,
                    'stroke': {
                      'color': 'rgba(0,0,0,1)',
                      'lineStyle': 'solid',
                      'width': 0.5
                    },
                    'symbol': 'circle',
                    'type': 'simpleSymbol'
                  },
                  'visible': true
                },
                {
                  'label': '\>1,000 - 500,000 m3',
                  'values': [1000,500000],
                  'settings': {
                    'color': 'rgba(223,115,255,1)',
                    'offset': [0,0],
                    'rotation': 0,
                    'size': 10.005,
                    'stroke': {
                      'color': 'rgba(0,0,0,1)',
                      'lineStyle': 'solid',
                      'width': 0.5
                    },
                    'symbol': 'circle',
                    'type': 'simpleSymbol'
                  },
                  'visible': true
                },
                {
                  'label': '\>500,000 - 5,000,000 m3',
                  'values': [500000,5000000],
                  'settings': {
                    'color': 'rgba(197,0,255,1)',
                    'offset': [0,0],
                    'rotation': 0,
                    'size': 14.007,
                    'stroke': {
                      'color': 'rgba(0,0,0,1)',
                      'lineStyle': 'solid',
                      'width': 0.5
                    },
                    'symbol': 'circle',
                    'type': 'simpleSymbol'
                  },
                  'visible': true
                },
                {
                  'label': '\>5,000,000 - 10,000,000 m3',
                  'values': [5000000,10000000],
                  'settings': {
                    'color': 'rgba(132,0,168,1)',
                    'offset': [0,0],
                    'rotation': 0,
                    'size': 18.009,
                    'stroke': {
                      'color': 'rgba(0,0,0,1)',
                      'lineStyle': 'solid',
                      'width': 0.5
                    },
                    'symbol': 'circle',
                    'type': 'simpleSymbol'
                  },
                  'visible': true
                },
                {
                  'label': '\>10,000,000 m3',
                  'values': [10000000,999000000],
                  'settings': {
                    'color': 'rgba(76,0,115,1)',
                    'offset': [0,0],
                    'rotation': 0,
                    'size': 23.345,
                    'stroke': {
                      'color': 'rgba(0,0,0,1)',
                      'lineStyle': 'solid',
                      'width': 0.5
                    },
                    'symbol': 'circle',
                    'type': 'simpleSymbol'
                  },
                  'visible': true
                },
                {
                  'label': 'No Data',
                  'values': [999000000,999999999],
                  'settings': {
                    'mimeType': 'image/png',
                    'offset': [0,0],
                    'opacity': 1,
                    'rotation': 0,
                    'src': 'iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAT0lEQVQYlWNhgIBQBvxgNQsDA0Noh4vLKiVBQawqzj57xtB59GgYCwMDA4OSoCBDqJYWXiNZCFg59BSeffYMp4J779/DFa7uPHo0jICBqwFMlhJ/CxAqXwAAAABJRU5ErkJggg==',
                    'type': 'iconSymbol'
                  },
                   'visible': true
                }
              ]
            }
          }
        ]
      }
    ]
  },
  'components': ['overview-map'],
  'footerBar': {
    'tabs': {
      'core': ['legend', 'layers', 'details', 'data-table']
    }
  },
  'corePackages': [],
  'theme': 'geo.ca'
}
`;
    // Config Snippet Selection Button ==================================================================================================

    const configSnippetSelector = document.getElementById('config-snippet');
    document.getElementById('configGeoview').value = simpleSnippet;

    // add an event listener to the config snippet selector
    configSnippetSelector.addEventListener('change', function (e) {
      const choice = configSnippetSelector.value;
      if (choice === 'simple') document.getElementById('configGeoview').value = simpleSnippet;
      else if (choice === 'uniqueValue') document.getElementById('configGeoview').value = uniqueValueSnippet;
      else document.getElementById('configGeoview').value = classBreaksSnippet;
    });

    // Config Validate Button============================================================================================================
    const validateJSONButton = document.getElementById('validateConfig');

    // add an event listener when a button is clicked
    validateJSONButton.addEventListener('click', function (e) {
      // get message element
      const message = document.getElementById('validationMessage');
      const langue = document.getElementById('language').value;
      const configArea = document.getElementById('configGeoview');
      const configOutput = document.getElementById('configOutput');

      // get config and test if JSON is valid
      const mapConfig = cgpv.api.configApi.getMapConfig(configArea.value, langue);
      configOutput.value = mapConfig.getIndentedJsonString();

      // Generate line numbers
      (() => {
        const textarea = document.getElementById('configOutput');
        const lineNumbersContainer = document.getElementById('outputLineNumbers');
        const lines = textarea.value.split('\n').length;
        const lineNumbers = Array.from({ length: lines }, (_, index) => '').join('<span />');
        lineNumbersContainer.innerHTML = lineNumbers;
      })();

      // set class and message
      message.classList.add('config-json-valid');
      message.classList.remove('config-error');
      if (mapConfig.isValid) {
        message.innerHTML = 'File is valid, see console for details...';
        document.getElementById('createMap').disabled = true;
      } else {
        message.innerHTML = 'File is invalid, see console for details...';
      }
    });

    // Config Url Validate Button========================================================================================================
    const validateURLButton = document.getElementById('validateUrlConfig');

    // add an event listener when the button is clicked
    validateURLButton.addEventListener('click', function (e) {
      // get message element
      const message = document.getElementById('validationMessage');
      const langue = document.getElementById('urlLanguage').value;
      const configArea = document.getElementById('configGeoview');
      const configUrlArea = document.getElementById('configUrlGeoview');
      const configOutput = document.getElementById('configOutput');

      configArea.value = configUrlArea.value;
      // get config and test if URL Config is valid
      const returnedValue = cgpv.api.configApi.getConfigFromUrl(configUrlArea.value);
      returnedValue.then((mapConfig) => {
        configOutput.value = mapConfig.getIndentedJsonString();

        // Generate line numbers
        (() => {
          const textarea = document.getElementById('configOutput');
          const lineNumbersContainer = document.getElementById('outputLineNumbers');
          const lines = textarea.value.split('\n').length;
          const lineNumbers = Array.from({ length: lines }, (_, index) => '').join('<span />');
          lineNumbersContainer.innerHTML = lineNumbers;
        })();

        // set class and message
        message.classList.add('config-json-valid');
        message.classList.remove('config-error');
        if (mapConfig.isValid) {
          message.innerHTML = 'File is valid, see console for details...';
          document.getElementById('createMap').disabled = true;
        } else {
          message.innerHTML = 'File is invalid, see console for details...';
        }
      });
    });

    // Create Button============================================================================================================
    const createMapButton = document.getElementById('createMap');
    createMapButton.disabled = true;

    // add an event listener when a button is clicked
    createMapButton.addEventListener('click', function (e) {
      // delete old map
      cgpv.api.maps['sandboxMap']?.remove(true);

      // create new map in a new dom node
      const newDiv = document.createElement('div');
      const a = document.createAttribute("id");
      a.value = "sandboxMap";
      newDiv.setAttributeNode(a);
      document.getElementById('mapSection').appendChild(newDiv);

      // create map
      cgpv.api.createMapFromConfig('sandboxMap', document.getElementById('configOutput').value);
    });

    const deleteMapButton = document.getElementById('deleteMap');
    deleteMapButton.disabled = true;

    // add an event listener when a button is clicked
    deleteMapButton.addEventListener('click', function (e) {
      // Delete the map
      cgpv.api.maps['sandboxMap'].remove(true);
    });

    // Editor script section===================================================================================================
    const textarea = document.querySelector('textarea');
    const lineNumbers = document.querySelector('.line-numbers');

    // set default number of lines
    const numberOfLines = textarea.value.split('\n').length;
    lineNumbers.innerHTML = Array(numberOfLines).fill('<span></span>').join('');

    textarea.addEventListener('keyup', (event) => {
      const numberOfLines = event.target.value.split('\n').length;
      lineNumbers.innerHTML = Array(numberOfLines).fill('<span></span>').join('');
    });

    textarea.addEventListener('input', (event) => {
      document.getElementById('createMap').disabled = true;
    });

    // create snippets
    window.addEventListener('load', () => {
      createCodeSnippet();
      createConfigSnippet();
    });
  </script>
</body>

</html>