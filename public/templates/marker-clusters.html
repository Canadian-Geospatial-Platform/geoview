<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title><%= htmlWebpackPlugin.options.title %></title>
        <link rel="shortcut icon" href="./favicon.ico" />
        <meta name="msapplication-TileColor" content="#da532c" />
        <meta name="msapplication-config" content="./img/browserconfig.xml" />
        <meta name="theme-color" content="#ffffff" />
        <meta name="msapplication-TileColor" content="#da532c" />
        <meta name="theme-color" content="#ffffff" />
        <link
            href="https://fonts.googleapis.com/css?family=Roboto|Montserrat:200,300,400,900|Merriweather"
            rel="stylesheet"
            type="text/css"
        />
        <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" />
        <script src="./plugins/basemap/basemap-switcher.js"></script>
        <link rel="stylesheet" href="css/style.css" />
        <link rel="stylesheet" href="css/cluster-marker-style.css" />
    </head>
    <body>
    <body>
        <div calss="header-table">
            <table>
                <tbody>
                    <tr>
                        <td><img class="header-logo" alt="logo" src="./img/Logo.png" /></td>
                        <td class="header-title">
                            <h1><strong>Marker Clusters</strong></h1>
                        </td>
                    </tr>
                    <tr>
                        <td><a href="./index.html">Main</a><br /></td>
                    </tr>
                </tbody>
            </table>
            <table>
                <tbody>
                    <tr>
                        <td>This page is used to showcase how marker clusters can be used.</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div>
            <h3 id="HLNG1">Marker Clusters</h3>
            <div
                id="LNG1"
                class="llwp-map"
                data-leaflet="{
                    'projection': 3978, 
                    'zoom': 4, 
                    'center': [60,-100], 
                    'language': 'fr-CA', 
                    'basemapOptions': { 
                        'id': 'transport', 
                        'shaded': true, 
                        'labeled': true 
                    }, 
                    'layers': [] 
                }"
            ></div>
        </div>
        <script>
             function addMarker(map) {
                // call an api function to draw markers
                const api = cgpv.api.map(map);
                api.addCircleMarker(56,-97, 1, null, 'CircleMarker-1');
                api.addCircle(58,-99, 10, null, 'Circle-1');

                marker1 = api.addMarker(56,-97, {
                    icon: api.markerDefinitions.yellowIcon,
                    title: 'Test-marker-1'
                }, 'marker-1');
                marker1.setIcon(api.markerDefinitions.greenIcon)

                marker2 = api.markerClusters.addClusterMarker(58,-98.5, {
                    selected: true,
                    title: 'Test-marker-2.1'
                }, 'marker-2.1');
                marker2.startBlinking();

                marker2 = api.markerClusters.addClusterMarker(58.2,-99.3, {
                    title: 'Test-marker-2.2'
                }, 'marker-2.2');

                marker2 = api.markerClusters.addClusterMarker(58,-99.4, {
                    title: 'Test-marker-2.3'
                }, 'marker-2.3');

                marker2 = api.markerClusters.addClusterMarker(57.9,-98.6, {
                    selected: true,
                    title: 'Test-marker-2.4'
                }, 'marker-2.4');

                marker2 = api.markerClusters.addClusterMarker(57.7,-99, {
                    selected: true,
                    title: 'Test-marker-2.5'
                }, 'marker-2.5');

                marker2 = api.markerClusters.addClusterMarker(57.7005,-99, {
                    title: 'Test-marker-2.6'
                }, 'marker-2.6');

                marker2 = api.markerClusters.addClusterMarker(57.7005,-99.0005, {
                    title: 'Test-marker-2.7'
                }, 'marker-2.7');

                api.markerClusters.setClusterGroupAsInvisible();
                api.markerClusters.setClusterGroupAsVisible();

                api.createGeometryGroup('myGroup');
                api.setActiveGeometryGroup('myGroup');
                cgpv.api.event.emit(cgpv.api.eventNames.EVENT_VECTOR_ADD, null, {type: 'marker', latitude: 57, longitude:-98, options: {title: 'Test-marker-3'}, id: 'Marker-3'})
                api.setGeometryGroupAsVisible('myGroup');
                api.setGeometryGroupAsInvisible('defaultGeomGroup');
                api.addToGeometryGroup(marker1, 'MarkerGroup');
                api.setGeometryGroupAsVisible('MarkerGroup');
            }

            function addModelsToAppbarPane(api) {
                const button = {
                    tooltip: 'Models',
                    icon: '<i class="material-icons">apps</i>',
                };

                const panel = {
                    title: 'Models',
                    icon: `<i class="material-icons">apps</i>`,
                    content: '',
                    width: 200,
                };

                // call an api function to add a panel with a button in the default group
                const modelPanel = api.createAppbarPanel(button, panel, 'model-selector').panel;
                modelPanel.attachCheckBoxList(['model 1', 'model 2', 'model 3', 'model 4', ], false);

            }

            // initialize s and api events, a callback is optional, used if calling api's after the rendering is ready
            cgpv.init(function () {
                console.log('api is ready');
                const api = cgpv.api.map('LNG1');
                api.map.on('boxzoomend', (e) => {
                    console.log('boxzoomend');
                    console.log(e);
                });
                api.map.on('boxselectend', (e) => {
                    console.log('boxselectend');
                    console.log(e);
                });
                const layerPanel = api.buttonPanel.getAppBarButtonPanelById('layer-panel').panel;
                layerPanel.attachCheckBoxList(['layer 1', 'layer 2', 'layer 3', 'layer 4', ], false);
                addModelsToAppbarPane(api);
                addMarker('LNG1');
            });
        </script>
    </body>
</html>
